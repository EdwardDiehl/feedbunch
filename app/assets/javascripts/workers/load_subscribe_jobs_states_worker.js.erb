/**
 * Web Worker to load the state of subscribe jobs in a separate thread.
 */

importScripts('<%= asset_path 'workers/common/do_get' %>');

// Callback for messages from the main thread
onmessage = function(e){
  // CSRF token
  var token = e.data.token;

  // id of a single job to query its state. Optional; if not present, the state of all subscribe jobs will be queries
  var id = e.data.id

  var url = "";
  if (id){
    url = "/api/subscribe_job_states/" + id + ".json";
  }
  else {
    url = "/api/subscribe_job_states.json";
  }

  do_get(url, token, 0);
}